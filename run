#!/bin/bash
if [ $# -lt 5 ]; then
    echo "usage: $0 L betamin betamax bits Nmeas"
    exit
fi

./bitrange $2 $3 $4 | sort > .bits
echo $1 > extent
scons -j8 bin || exit

for beta in $(cat .bits | mycut 1 )
do
    echo "bin/ising-$1-$beta $5 | (read line; echo \$(date +%T) \$line)"
done | parallelize 4
